{% extends 'shops/basic.html' %}
{% block title %}
Home Page
{% endblock title %}
{% block css %}
.card-class{
        height:40vh;
        width: 20vw;
        /*margin: auto;*/
        margin-top: 1vw;
        
      }
card-body-class{
  height:8vh;
}
    
      .card-img-up{
        margin-left:2.5vw;
        margin-top: 0.5vh;
        margin-bottom: 0.5vh;
        height: 10vh;
        width: 15vw;
      }
      .carousel-inner{
        margin: auto;
        width: max-content;
        height: max-content;
      }
      .carousel-control-prev,
.carousel-control-next{
    align-items: flex-end;;
    /* Aligns it at the bottom */
}

.carousel-indicators li{
  background-color: grey;
}
.carousel-control-prev span,.carousel-control-next span{
  background-color: grey;
}
{% endblock css %}
{% block body %}
    {% for j in allprods%}
    
    <h5 class="my-4">Flash Sale On {{j.0.0.category}} - Recommended Items</h5>
      <div id="mycarousel{{forloop.counter}}" class="carousel" data-ride="carousel">
          <ol class="carousel-indicators">
            <li data-target="#mycarousel{{forloop.counter}}" data-slide-to="0" class="active"></li> 
            {% for i in product_length %}
            <li data-target="#mycarousel{{forloop.parentloop.counter}}" data-slide-to={{i}} ></li> 
            {%endfor%}
          </ol>
          
          <div class="carousel-inner">
            <div class="carousel-item active">
              <div class="card card-class">
                <div class="card-body card-body-class">
                  <h5 class="card-title">{{j.0.0.product_name}}</h5>
                  {% comment %} <p class="card-text">{{product.0.category}}</p> {% endcomment %}
                  <p class="card-text"><small class="text-muted">{{j.0.0.desc}}</small></p>
                  <button id="pr{{j.0.0.id}}" type="button" class="btn btn-primary cart">Add to cart</button>
                  <a href="/shops/productview/{{j.0.0.id}}"><button id="qr{{j.0.0.id}}" type="button" class="btn btn-primary cart" >Quick View</button></a>
                </div>
                <img class="card-img-bottom" src='/media/{{j.0.0.image}}' alt="Card image cap">
              </div>
            </div>
            {% comment %} {{range}} {% endcomment %}
            {% for i in j.0|slice:"1:"%}
              
            {% comment %} {% if forloop.counter|divisibleby:3 and forloop.counter > 0  %} {% endcomment %}
            <div class="carousel-item">
              <div class="card card-class">
                <div class="card-body card-body-class">
                  <h5 class="card-title">{{i.product_name}}</h5>
                  {% comment %} <p class="card-text">{{i.category}}</p> {% endcomment %}
                  <p class="card-text"><small class="text-muted">{{i.desc}}</small></p>
                  <button id="pr{{i.id}}" type="button" class="btn btn-primary cart" >Add to cart</button>
                  <a href="/shops/productview/{{i.id}}"><button id="qr{{i.id}}" type="button" class="btn btn-primary cart" >Quick View</button></a>
                </div>
                <img class="card-img-up" src='/media/{{i.image}}' alt="Card image cap">
              </div>
            {% comment %} {% endif%} {% endcomment %}
              </div>
            
            {% endfor%}
            

            
            
          </div>

          <a class="carousel-control-prev" href="#mycarousel{{forloop.counter}}" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#mycarousel{{forloop.counter}}" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>

        </div>
      {% endfor%}
{% endblock body %}
{% block script%}
  if(localStorage.getItem('cart')==null){
    var cart={};
  }
  else{
    
    cart=JSON.parse(localStorage.getItem('cart'));
  }
$('.cart').click(function(){
  console.log("you have clicked me");
  
  
  var idd=this.id.toString();
  if(cart[idd]!=undefined){
    cart[idd]=cart[idd]+1;
  }
  else
  {
    console.log("you have entered inside me");
    document.getElementById('carts').innerHTML = Object.keys(cart).length;
    cart[idd]=1;
  }
  localStorage.setItem('cart',JSON.stringify(cart));
});
$('#popcart').popover();
document.getElementById("popcart").setAttribute('data-content', '<h5>Here is my cart</h5>');
{% endblock script%}
        

    